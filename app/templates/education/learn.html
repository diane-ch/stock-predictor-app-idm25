<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Learning Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/learn.css') }}">
  <script>
  // Make the static URL available to external JavaScript
  window.STATIC_LESSONS_URL = "{{ url_for('static', filename='images/lessons/') }}";
  </script>
  <script src="{{ url_for('static', filename='js/learn.js') }}"></script>
</head>
<body>

  <div class="main-wrapper">

      <div class="top-header">
      <h2>Your learning path</h2>
      <div class="menu-wrapper">
        <div class="menu-icon" onclick="toggleMenu()">â‹®</div>
        <div class="logout-menu" id="logoutMenu">

          <!-- Tutorial -->
          <button class="menu-item" id="tutorialBtn">
            <span class="menu-text">Tutorial</span>
            <img src="../../static/images/Tutoriallogo.png" class="menu-icon-right" alt="Tutorial Icon" />
          </button>

        <div class="menu-divider"></div>

          <!-- Terms -->
          <button class="menu-item" id="termsBtn" onclick="window.location.href='{{ url_for('auth.terms_full') }}'">
            <span class="menu-text">Terms & Privacy</span>
            <img src="../../static/images/termslogo.png" class="menu-icon-right" alt="Terms Icon" />
          </button>

          <div class="menu-divider"></div>

          <a href="{{ url_for('auth.logout') }}" class="logout-button">
            <span class="logout-text">Log Out</span>
            <img src="{{ url_for('static', filename='images/logout.png') }}" class="logout-icon" alt="logout arrow" />
          </a>
          
        </div>
        </div>
    </div>

    <!-- å­¦ä¹ è¿›åº¦æ–‡å­— + æ¨ªçº¿ -->
    <div class="progress-line-wrapper">
      <div class="progress-text">ðŸ“š 
        {% set total_completed_lessons = modules_data | sum(attribute='progress.completed_lessons', start=0) %}
        {% set total_lessons = modules_data | sum(attribute='progress.total_lessons', start=0) %}
        {{ total_completed_lessons }}/{{ total_lessons }} Completed
      </div>
      <hr class="progress-line" />
    </div>


    <!-- å¯æ»šåŠ¨å†…å®¹åŒºåŸŸ -->
    <div class="scrollable-content">
      <div class="content-placeholder">

        {% for module_data in modules_data %}
        <div class="learning-card">
          <div class="card-top">
            <img src="{{ url_for('static', filename='images/' + module_data.module['icon']) }}" 
            alt="avatar" class="card-avatar" data-module-id="{{ module_data.module.id }}"/>
            <div class="card-info">
              <div class="card-title">
                {{ module_data.module['emoji'] }} <strong>{{ module_data.module['title'] }}</strong>
              </div>
              <div class="card-subtitle">{{ module_data.module['description'] }}</div>
            </div>
            {% if module_data.status == "locked" %}
              <div class="card-status" style="background-color: #ccc;">ðŸ”’ Locked</div>
            {% elif module_data.status == "completed" %}
              <div class="card-status" style="background-color: #4CAF50;">ðŸŽ‰ Completed</div>
            {% elif module_data.status == "available" %}
              <div class="card-status" style="background-color: #2196F3;">ðŸ“š Available</div>
            {% endif %}
          </div>
          
          <div class="card-stars">
            {% for lesson_circle in module_data.lesson_circles %}
              <div class="star-circle 
                  {% if lesson_circle.is_unlocked %}
                    {% if lesson_circle.is_completed %}
                      completed-circle
                    {% else %}
                      learning-circle
                    {% endif %}
                  {% else %}
                    gray-circle
                  {% endif %}"
                  {% if lesson_circle.is_unlocked %}
                    onclick="openVideoCard('{{ module_data.module.id }}', '{{ lesson_circle.lesson_id }}')"
                  {% endif %}>
                
                {% if lesson_circle.is_completed %}
                  <img src="{{ url_for('static', filename='images/star.png') }}" alt="star" />
                {% else %}
                  {{ loop.index }}
                {% endif %}
              </div>
            {% endfor %}
          </div>
        </div>
        {% endfor %}

      </div>
    </div>

      <nav class="bottom-nav">
    <a href="{{ url_for('main.ai_predictions') }}" class="nav-item">
      <img src="../../static/images/predictions-inactive.png" alt="AI Predictions">
      <span>AI Predictions</span>
    </a>
    <a href="{{ url_for('main.discover') }}" class="nav-item">
      <img src="../../static/images/discover-inactive.png" alt="Disc#f5f6f7over">
      <span>Discover</span>
    </a>
    <a href="{{ url_for('main.learning')}}" class="nav-item active">
      <img src="../../static/images/learn-active.png" alt="Learn">
      <span>Learn</span>
    </a>
  </nav>


  </div>

  
<div class="video-popup-overlay" id="videoPopup">
  <div class="video-popup-card">
    <div class="video-popup-header">
      <div class="popup-badge" id="popupCategory"></div>
      <div class="popup-badge" id="popupTime"></div>
    </div>

    <img src="" alt="lesson" class="lesson-image" id="popupImage" />

    <div class="lesson-title" id="popupTitle"></div>
    <div class="lesson-desc" id="popupDesc"></div>

    <div class="start-btn-container">
      <div class="start-divider"></div>
      <button class="start-btn" id="startLearningBtn" onclick="startLesson()">Start Learning</button>
    </div>
  </div>
</div>


<!-- Tutorial Modalï¼ˆå¤§å¼¹çª—ï¼‰ -->
<div class="modal-overlay" id="tutorialModal">
  <div class="modal-card">
    <h3 class="modal-title">What you need to know about your Smart Picks</h3>

    <p class="modal-sub">
      In here you will find daily digest of the top five predictions or pick of stocks for the day.
      <br>New picks every 24 hours
    </p>

    <!-- 1) æ—¥æœŸ/å€’è®¡æ—¶ç¤ºæ„å›¾ï¼ˆæ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡ï¼‰ -->
    <figure class="tutorial-figure">
      <img src="../../static/images/tutorial-date.png" alt="date example" class="tutorial-img">
    </figure>

    <p class="modal-desc">
      Each pick includes: The name of the stock, the price and percentage of change that is predicted for the end of the day, and a confidence score
    </p>

    <!-- 2) è‚¡ç¥¨å¡ç‰‡ç¤ºæ„å›¾ -->
    <figure class="tutorial-figure">
      <img src="../../static/images/tutorial-card.png" alt="card example" class="tutorial-img">
    </figure>

    <p class="modal-desc">
      Whenever you see this icon you will know that this was an AI prediction and the level of confidence it has
    </p>

    <!-- 3) ç½®ä¿¡åº¦ç¤ºæ„å›¾ -->
    <figure class="tutorial-figure">
      <img src="../../static/images/tutorial-confidence.png" alt="confidence example" class="tutorial-img">
    </figure>

    <p class="modal-desc">
      You can see more details on the stock picks like the features taken into consideration for each prediction
    </p>

    <button class="modal-close" id="tutorialCloseBtn">Close</button>
  </div>
</div>
  

</body>
</html>
